<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading and Understanding Experience - Digital Accessibility Empathy Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- CONSTANT LAB UI STYLES --- */
        .lab-ui-font { font-family: ui-sans-serif, system-ui, -apple-system, sans-serif !important; }
        .info-panel-container { min-height: 550px !important; display: flex; flex-direction: column; }
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ef4444; transition: .4s; border-radius: 28px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #15803d; }
        input:checked + .slider:before { transform: translateX(22px); }
        .tab-btn { font-family: ui-sans-serif, system-ui, sans-serif !important; }
        .tab-btn[aria-selected="true"] { background-color: #111827; color: #60a5fa; border-bottom: 2px solid #60a5fa; }

        /* --- READING BARRIERS --- */
        .inaccessible-mode .reading-content { font-family: "Times New Roman", Times, serif !important; }
        .promo-banner {
            width: 100%; height: 60px;
            background-color: #ef4444; color: white;
            display: flex; align-items: center; justify-content: center;
            font-weight: 900; overflow: hidden; position: relative;
            border-radius: 8px;
        }
        .promo-text { white-space: nowrap; animation: slide 4s linear infinite; }
        @keyframes slide { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .inaccessible-mode .promo-banner { animation: flash 1s step-end infinite; margin-bottom: 24px; }
        @keyframes flash { 50% { background-color: #facc15; color: black; } }

        /* Complex Promo Code Image Style */
        .promo-img {
            height: 30px;
            filter: contrast(150%);
            pointer-events: none;
            user-select: none;
        }

        .inaccessible-mode #txt-instructions { text-align: justify; line-height: 0.95 !important; letter-spacing: -0.04em !important; font-size: 14px; }
        .inaccessible-mode #txt-instr-title { font-size: 14px !important; margin-bottom: 2px !important; text-transform: none !important; }
        .inaccessible-mode .cog-label { font-size: 12px !important; text-transform: uppercase !important; font-weight: 900 !important; }

        /* --- ACCESSIBLE MODE --- */
        .accessible-mode .reading-content { font-family: ui-sans-serif, system-ui, sans-serif !important; }
        .accessible-mode .promo-banner { background-color: #1e40af; animation: none; margin-bottom: 24px; }
        .accessible-mode .promo-text { animation: none; transform: none; white-space: normal; }
        .accessible-mode #txt-instructions { text-align: left; line-height: 1.8; font-size: 14px; }
        .accessible-mode .cog-label { font-size: 14px !important; text-transform: none !important; font-weight: 600; letter-spacing: 0.01em; }
        .accessible-mode .form-gap { gap: 1.5rem !important; }

        /* Carousel Controls */
        .carousel-btn {
            display: flex; align-items: center; justify-content: center;
            width: 32px; height: 32px; border: 2px solid #1e40af;
            border-radius: 6px; background: white; color: #1e40af;
            transition: all 0.2s; cursor: pointer; font-size: 0.9rem;
        }
        .carousel-btn:hover { background: #f3f4f6; }

        .instr-list br { content: ""; display: block; margin: 0.75rem 0; }
        .input-error { border: 2px solid #ef4444 !important; }
        .error-msg { color: #ef4444; font-size: 12px; font-weight: bold; margin-top: 4px; display: block; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 transition-colors duration-500 lab-ui-font" id="bodyTag">

    <div class="max-w-7xl mx-auto bg-white shadow-2xl rounded-3xl overflow-hidden">
        <header class="bg-white border-b border-gray-100 lab-ui-font">
            <div class="p-6 flex flex-col md:flex-row justify-between items-center gap-6 border-b border-gray-50">
                <div id="txt-lab-title" class="text-xl md:text-2xl font-black tracking-tight uppercase" style="color: #008B63;">Digital Accessibility Empathy Lab</div>
                <img src="https://regine-lambrecht.github.io/color-contrast-checker-size-weight/images/banner.png" alt="Logo" class="h-12">
            </div>

            <nav class="p-4 flex flex-col gap-4">
                <div class="flex items-center justify-between gap-4 bg-gray-50 p-3 rounded-2xl border border-gray-200 w-full">
                    <div class="flex items-center gap-4">
                        <span id="txt-inaccessible" class="text-xs font-black uppercase tracking-widest text-red-600">Inaccessible</span>
                        <label class="switch">
                            <input type="checkbox" id="modeToggle" onchange="handleModeToggle()" role="switch">
                            <span class="slider"></span>
                        </label>
                        <span id="txt-accessible" class="text-xs font-black uppercase tracking-widest text-green-700">Accessible</span>
                    </div>
                    <div class="flex gap-2 text-[10px] font-bold">
                        <button onclick="setLanguage('en')" class="lang-btn px-2 py-1 rounded" id="btn-en">EN</button>
                        <button onclick="setLanguage('fr')" class="lang-btn px-2 py-1 rounded" id="btn-fr">FR</button>
                        <button onclick="setLanguage('nl')" class="lang-btn px-2 py-1 rounded" id="btn-nl">NL</button>
                        <button onclick="setLanguage('de')" class="lang-btn px-2 py-1 rounded" id="btn-de">DE</button>
                    </div>
                </div>
                <h1 id="txt-title" class="text-xl font-black text-gray-900 px-2 uppercase tracking-tighter">Reading and Understanding Experience</h1>
            </nav>
        </header>

        <main class="p-6 md:p-10">
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-16">
                <div class="lg:col-span-2 reading-content flex flex-col form-gap" id="exercise-column">
                    <div id="form-container" class="contents">
                        <div class="flex flex-col">
                            <div class="promo-banner" id="banner">
                                <span class="promo-text flex items-center gap-2" id="banner-content">
                                    <span id="txt-promo-prefix">APPLY NOW! 50% OFF PROMO CODE:</span>
                                    <span id="promo-code-container"></span>
                                </span>
                            </div>
                        </div>
                        <div id="vague-error" class="hidden bg-red-100 text-red-700 p-3 rounded-lg text-sm font-bold mb-4" role="alert">Fail to submit form</div>
                        
                        <div class="bg-blue-50 p-5 rounded-xl border border-blue-100 mt-4 relative">
                            <div class="flex justify-between items-center mb-3">
                                <h2 id="txt-instr-title" class="font-bold uppercase text-lg text-blue-900 lab-ui-font">Instructions</h2>
                                <div id="carousel-controls" class="flex gap-2 hidden">
                                    <button onclick="prevSlide()" class="carousel-btn" id="btn-prev" aria-label="Previous slide">❮</button>
                                    <button onclick="nextSlide()" class="carousel-btn" id="btn-next" aria-label="Next slide">❯</button>
                                </div>
                            </div>
                            <div id="txt-instructions" class="min-h-[100px] flex items-center"></div>
                        </div>

                        <div class="space-y-4 mt-6">
                            <div>
                                <label id="txt-label-name" class="cog-label block mb-1">Name</label>
                                <input type="text" id="inp-name" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm lab-ui-font">
                                <span id="err-name" class="error-msg hidden" role="alert"></span>
                            </div>
                            <div>
                                <label id="txt-label-code" class="cog-label block mb-1">CODE</label>
                                <input type="text" id="inp-code" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm lab-ui-font">
                                <span id="err-code" class="error-msg hidden" role="alert"></span>
                            </div>
                        </div>
                        <button id="txt-btn" onclick="validateForm()" class="w-full bg-blue-600 hover:bg-blue-800 text-white font-bold py-3 px-6 rounded-lg text-sm tracking-wide transition-colors lab-ui-font mt-6">OK</button>
                    </div>
                </div>

                <div class="lg:col-span-3">
                    <div class="info-panel-container bg-gray-900 text-white rounded-2xl shadow-xl overflow-hidden h-full flex flex-col lab-ui-font">
                        <div class="flex bg-gray-800 border-b border-gray-700">
                            <button id="tab-test" onclick="switchTab('test')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest" aria-selected="true">How to test</button>
                            <button id="tab-feedback" onclick="switchTab('feedback')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Issues</button>
                            <button id="tab-user" onclick="switchTab('user')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Impacted users</button>
                        </div>
                        <div id="panel-test" class="p-8 space-y-6 text-sm flex-grow">
                            <h3 id="txt-guide-title" class="text-blue-400 font-bold uppercase text-xs mb-2">Step-by-step guide</h3>
                            <ol id="txt-test-steps" class="list-decimal pl-5 space-y-4 opacity-95"></ol>
                        </div>
                        <div id="panel-feedback" class="p-8 hidden text-sm flex-grow overflow-y-auto">
                            <h3 id="txt-feedback-title" class="text-blue-400 font-bold uppercase mb-6"></h3>
                            <div id="critiqueContent" class="space-y-6"></div>
                        </div>
                        <div id="panel-user" class="p-8 hidden text-sm flex-grow overflow-y-auto">
                            <div id="txt-user-content" class="leading-relaxed opacity-95 text-sm"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const translations = {
            en: {
                inaccessible: "Inaccessible", accessible: "Accessible", labTitle: "Digital Accessibility Empathy Lab", title: "Reading and Understanding Experience",
                name: { bad: "Identifier", good: "Full Name (required)" }, code: { bad: "CODE", good: "Promotional Code" }, 
                btn: { bad: "OK", good: "Submit Application" }, promoPrefix: "APPLY NOW! 50% OFF PROMO CODE:",
                namePlaceholder: "Type your identifier", codePlaceholder: "eg: SZ1ILOQ",
                instrTitle: "Instructions", guideTitle: "Step-by-step guide", prevAria: "Previous slide", nextAria: "Next slide",
                tabTest: "How to test", tabUser: "Impacted users", tabIssues: "Issues", tabRemediations: "Remediations",
                successMsg: "Your request was successfully submitted", failMsg: "Fail to submit form",
                errReqName: "Full Name is required", errInvalidCode: "Invalid promotional code",
                instrSlides: [
                    "Fill in the form with the promo code.",
                    "You will receive an e-mail asking to confirm.",
                    "You must acknowledge the reception.",
                    "You can return the product if you are not satisfied within 15 d."
                ],
                testSteps: [
                    "Read the 'Instructions' block and identify the required pieces of information.",
                    "Look for the promotional code in the banner.",
                    "Try to complete the form without entering any data to see how the system handles errors.",
                    "Complete the form using the found information.",
                    "Switch to the accessible version and compare clarity."
                ],
                critiques: {
                    bad: { title: "What is wrong?", items: [
                        { f: "Uncontrolled Content", c: "The instructions change automatically without giving enough time to read, and there is no way to stop or go back." },
                        { f: "Unreadable Text", c: "The use of italicized images for codes prevents users from adjusting fonts. Overuse of bold text on non-important words distracts the eye." },
                        { f: "Vague & Distracting Labels", c: "The label 'Identifier' is confusing, and placeholders containing jargon or useless examples make it harder to know what to type." },
                        { f: "Poor Error Feedback", c: "The error message is generic and does not point to the specific field that needs correction." },
                        { f: "Missing Confirmation", c: "The form resets without a clear message, leaving people unsure if their submission worked." }
                    ]},
                    good: { title: "Remediations", items: [
                        { f: "User Control", c: "Allow people to navigate through instructions at their own pace using manual buttons." },
                        { f: "Clear Formatting", c: "Use standard text that can be resized. Use bold only for key terms and maintain clear line spacing." },
                        { f: "Direct Labels", c: "Use simple, familiar labels like 'Full Name' and remove confusing placeholder text." },
                        { f: "Specific Error Guidance", c: "Highlight the exact field that has an error and explain how to fix it." },
                        { f: "Permanent Success Feedback", c: "Provide a clear and lasting message confirming that the task is finished." }
                    ]}
                },
                userTitle: "Who is impacted?", userList: [
                    "**ADHD / Autism:** Distracting bold text and moving parts make it very difficult to concentrate on the actual task.",
                    "**Dyslexia:** Tight spacing and fonts that mix up similar-looking letters (like S, 5, I, L) create significant reading barriers.",
                    "**Deaf people:** Some people who use sign language as their first language may have a smaller vocabulary in written text, making complex jargon or long instructions harder to process.",
                    "**Cognitive Impairment:** Fast-moving carousels and vague labels cause frustration when people cannot process the information in time."
                ]
            },
            fr: {
                inaccessible: "Inaccessible", accessible: "Accessible", labTitle: "Laboratoire d'empathie sur l'accessibilité numérique", title: "Expérience de lecture et compréhension",
                name: { bad: "Identifiant", good: "Nom complet (requis)" }, code: { bad: "CODE", good: "Code promotionnel" }, 
                btn: { bad: "OK", good: "Soumettre ma demande" }, promoPrefix: "POSTULEZ ! -50% CODE :",
                namePlaceholder: "Saisissez votre identifiant", codePlaceholder: "ex: SZ1ILOQ",
                instrTitle: "Instructions", guideTitle: "Guide étape par étape", prevAria: "Diapositive précédente", nextAria: "Diapositive suivante",
                tabTest: "Comment tester", tabUser: "Utilisateurs impactés", tabIssues: "Problèmes", tabRemediations: "Corrections",
                successMsg: "Votre demande a été soumise avec succès", failMsg: "Échec de l'envoi du formulaire",
                errReqName: "Le nom complet est requis", errInvalidCode: "Code promotionnel invalide",
                instrSlides: [
                    "Remplissez le formulaire avec le code promo.",
                    "Vous recevrez un e-mail demandant confirmation.",
                    "Vous devez accuser réception.",
                    "Retour produit possible sous 15 j si non satisfait."
                ],
                testSteps: ["Lisez les instructions.", "Cherchez le code.", "Testez les erreurs.", "Remplissez le formulaire.", "Comparez les modes."],
                critiques: {
                    bad: { title: "Quel est le problème ?", items: [
                        { f: "Contenu non contrôlé", c: "Le carrousel change trop vite sans laisser le temps de lire, et aucun bouton ne permet de revenir en arrière." },
                        { f: "Texte illisible", c: "L'usage d'images en italique pour les codes empêche l'adaptation du texte. Le gras excessif distrait inutilement." }
                    ]},
                    good: { title: "Corrections", items: [
                        { f: "Contrôle utilisateur", c: "Permettez de naviguer dans les instructions à son propre rythme avec des boutons manuels." },
                        { f: "Mise en forme claire", c: "Utilisez du texte standard et ne mettez en gras que les termes essentiels." }
                    ]}
                },
                userTitle: "Qui est impacté ?", userList: [
                    "**TDAH / Autisme :** Les éléments en mouvement et le gras excessif empêchent la concentration.",
                    "**Personnes sourdes :** La lecture de textes complexes demande plus d'efforts si le vocabulaire écrit est moins familier.",
                    "**Dyslexie :** Les codes mélangeant des lettres similaires sont très difficiles à déchiffrer."
                ]
            },
            nl: {
                inaccessible: "Niet Toegankelijk", accessible: "Toegankelijk", labTitle: "Digital Accessibility Empathy Lab", title: "Ervaring in lezen en begrijpen",
                name: { bad: "Identificatie", good: "Volledige Naam (verplicht)" }, code: { bad: "CODE", good: "Promotiecode" }, 
                btn: { bad: "OK", good: "Aanvraag Verzenden" }, promoPrefix: "NU AANMELDEN! 50% KORTING:",
                namePlaceholder: "Typ uw identificatie", codePlaceholder: "bijv: SZ1ILOQ",
                instrTitle: "Instructies", guideTitle: "Stappenplan", prevAria: "Vorige dia", nextAria: "Volgende dia",
                tabTest: "Hoe te testen", tabUser: "Impact op gebruikers", tabIssues: "Problemen", tabRemediations: "Oplossingen",
                successMsg: "Uw aanvraag is succesvol verzonden", failMsg: "Formulier verzenden mislukt",
                errReqName: "Volledige naam is verplicht", errInvalidCode: "Ongeldige promotiecode",
                instrSlides: [
                    "Vul het formulier in met de promotiecode.",
                    "U ontvangt een e-mail ter bevestiging.",
                    "U moet de ontvangst bevestigen.",
                    "Retourneren binnen 15 d mogelijk bij ontevredenheid."
                ],
                testSteps: ["Lees de instructies.", "Zoek de code.", "Test fouten.", "Vul in.", "Vergelijk."],
                critiques: {
                    bad: { title: "Wat is er mis?", items: [
                        { f: "Ongecontroleerde inhoud", c: "De carrousel gaat te snel om te lezen en kan niet worden gestopt." },
                        { f: "Onleesbare tekst", c: "Afbeeldingen voor codes kunnen niet worden aangepast. Te veel vetgedrukte tekst leidt af." }
                    ]},
                    good: { title: "Oplossingen", items: [
                        { f: "Gebruikerscontrole", c: "Laat mensen de instructies handmatig bedienen met knoppen." },
                        { f: "Duidelijke opmaak", c: "Gebruik standaard tekst en beperk het gebruik van vetgedrukte woorden." }
                    ]}
                },
                userTitle: "Wie wordt beïnvloed?", userList: [
                    "**ADHD / Autisme :** Bewegende delen en willekeurig vetgedrukte tekst verstoren de focus.",
                    "**Doven :** Het lezen van complexe teksten kost meer moeite als de schriftelijke woordenschat beperkter is.",
                    "**Dyslexie :** Codes met letters die op elkaar lijken zijn een grote barrière."
                ]
            },
            de: {
                inaccessible: "Nicht Barrierefrei", accessible: "Barrierefrei", labTitle: "Empathie-Labor", title: "Lese- und Verständnis-Erfahrung",
                name: { bad: "Identifikator", good: "Vollständiger Name (erforderlich)" }, code: { bad: "CODE", good: "Aktionscode" }, 
                btn: { bad: "OK", good: "Antrag Absenden" }, promoPrefix: "JETZT BEWERBEN! 50% RABATT:",
                namePlaceholder: "Geben Sie Ihren Identifikator ein", codePlaceholder: "z.B.: SZ1ILOQ",
                instrTitle: "Anleitung", guideTitle: "Schritt-für-Schritt-Anleitung", prevAria: "Vorherige Folie", nextAria: "Nächste Folie",
                tabTest: "Wie man testet", tabUser: "Betroffene Nutzer", tabIssues: "Probleme", tabRemediations: "Lösungen",
                successMsg: "Ihr Antrag wurde erfolgreich übermittelt", failMsg: "Senden fehlgeschlagen",
                errReqName: "Vollständiger Name ist erforderlich", errInvalidCode: "Ungültiger Aktionscode",
                instrSlides: [
                    "Formular mit Aktionscode ausfüllen.",
                    "Sie erhalten eine Bestätigungs-E-Mail.",
                    "Empfang muss bestätigt werden.",
                    "Rückgabe innerhalb von 15 T bei Nichtgefallen."
                ],
                testSteps: ["Anleitung lesen.", "Code suchen.", "Fehler prüfen.", "Ausfüllen.", "Modus wechseln."],
                critiques: {
                    bad: { title: "Was ist falsch?", items: [
                        { f: "Unkontrollierte Inhalte", c: "Das Karussell wechselt zu schnell und lässt sich nicht stoppen." },
                        { f: "Unlesbarer Text", c: "Bilder statt Text verhindern Anpassungen. Zu viel Fettschrift lenkt ab." }
                    ]},
                    good: { title: "Lösungen", items: [
                        { f: "Benutzerkontrolle", c: "Ermöglichen Sie das manuelle Navigieren durch die Anleitung mit Tasten." },
                        { f: "Klare Formatierung", c: "Nutzen Sie Standardtext und heben Sie nur Schlüsselwörter fett hervor." }
                    ]}
                },
                userTitle: "Wer ist betroffen?", userList: [
                    "**ADHS / Autismus :** Blinkende Elemente und unnötige Fettschrift stören die Konzentration.",
                    "**Gehörlose Menschen :** Das Lesen komplexer Texte erfordert mehr Aufwand, wenn der schriftliche Wortschatz geringer ist.",
                    "**Legasthenie :** Codes mit ähnlichen Buchstaben sind schwer zu entziffern."
                ]
            }
        };

        let currentLang = 'en';
        let currentSlide = 0;
        let carouselInterval = null;

        const complexPromoImg = `<img src="https://placehold.co/100x30/dc2626/ffffff/png?text=S5bd1L&font=playfair-display" class="promo-img italic" alt="Promo Code">`;

        function updateCarousel() {
            const isAcc = document.getElementById('modeToggle').checked;
            const t = translations[currentLang];
            const display = document.getElementById('txt-instructions');
            let content = t.instrSlides[currentSlide];

            if (!isAcc) {
                // Randomly add bold tags to distract
                const words = content.split(' ');
                content = words.map((w, i) => i % 2 === 0 ? `<b>${w}</b>` : w).join(' ');
            }
            
            display.innerHTML = isAcc ? `<ul class="list-disc pl-5"><li>${content}</li></ul>` : content;
        }

        function nextSlide() {
            const t = translations[currentLang];
            currentSlide = (currentSlide + 1) % t.instrSlides.length;
            updateCarousel();
        }

        function prevSlide() {
            const t = translations[currentLang];
            currentSlide = (currentSlide - 1 + t.instrSlides.length) % t.instrSlides.length;
            updateCarousel();
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang] || translations['en'];
            const isAcc = document.getElementById('modeToggle').checked;
            
            document.documentElement.lang = lang;
            document.getElementById('txt-lab-title').innerText = t.labTitle;
            document.getElementById('txt-title').innerText = t.title;
            document.getElementById('txt-inaccessible').innerText = t.inaccessible;
            document.getElementById('txt-accessible').innerText = t.accessible;
            document.getElementById('txt-label-name').innerText = isAcc ? t.name.good : t.name.bad;
            document.getElementById('txt-label-code').innerText = isAcc ? t.code.good : t.code.bad;
            document.getElementById('txt-btn').innerText = isAcc ? t.btn.good : t.btn.bad;
            document.getElementById('txt-promo-prefix').innerText = t.promoPrefix;
            document.getElementById('vague-error').innerText = t.failMsg;
            document.getElementById('txt-instr-title').innerText = t.instrTitle;
            document.getElementById('txt-guide-title').innerText = t.guideTitle;
            document.getElementById('txt-test-steps').innerHTML = (t.testSteps || []).map(s => `<li>${s}</li>`).join('');
            document.getElementById('tab-test').innerText = t.tabTest;
            document.getElementById('tab-user').innerText = t.tabUser;
            document.getElementById('tab-feedback').innerText = isAcc ? t.tabRemediations : t.tabIssues;

            document.getElementById('btn-prev').setAttribute('aria-label', t.prevAria);
            document.getElementById('btn-next').setAttribute('aria-label', t.nextAria);

            // Jargon placeholders for inaccessible mode
            const inpName = document.getElementById('inp-name');
            const inpCode = document.getElementById('inp-code');
            if (!isAcc) {
                inpName.placeholder = t.namePlaceholder;
                inpCode.placeholder = t.codePlaceholder;
            } else {
                inpName.placeholder = "";
                inpCode.placeholder = "";
            }

            document.getElementById('txt-user-content').innerHTML = `
                <h3 class="text-blue-400 font-bold uppercase mb-4 text-xs">${t.userTitle}</h3>
                <ul class="list-disc pl-5 space-y-3">${(t.userList||[]).map(li => `<li>${li.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')}</li>`).join('')}</ul>
            `;

            updateCarousel();
            updateMode();
            
            document.querySelectorAll('.lang-btn').forEach(b => {
                b.classList.remove('bg-blue-600', 'text-white', 'bg-gray-200', 'text-gray-700');
                if (b.id === 'btn-' + lang) b.classList.add('bg-blue-600', 'text-white');
                else b.classList.add('bg-gray-200', 'text-gray-700');
            });
        }

        function validateForm() {
            const isAcc = document.getElementById('modeToggle').checked;
            const nameVal = document.getElementById('inp-name').value.trim();
            const codeVal = document.getElementById('inp-code').value.trim();
            const t = translations[currentLang];
            document.getElementById('vague-error').classList.add('hidden');
            ['name', 'code'].forEach(id => {
                const el = document.getElementById('inp-' + id);
                if(el) el.classList.remove('input-error');
                const err = document.getElementById('err-' + id);
                if(err) err.classList.add('hidden');
            });

            if (isAcc) {
                if (!nameVal) {
                    document.getElementById('inp-name').classList.add('input-error');
                    document.getElementById('err-name').innerText = t.errReqName;
                    document.getElementById('err-name').classList.remove('hidden');
                    return;
                }
                document.getElementById('form-container').innerHTML = `<div class="bg-green-100 text-green-800 p-8 rounded-2xl border-2 border-green-200 text-center font-bold text-lg" role="status">${t.successMsg}</div>`;
            } else {
                if (!nameVal || codeVal !== 'S5bd1L') {
                    document.getElementById('vague-error').classList.remove('hidden');
                } else {
                    document.getElementById('inp-name').value = '';
                    document.getElementById('inp-code').value = '';
                }
            }
        }

        function handleModeToggle() {
            if (!document.getElementById('form-container')) location.reload();
            setLanguage(currentLang);
        }

        function updateMode() {
            const isAcc = document.getElementById('modeToggle').checked;
            const banner = document.getElementById('banner');
            const codeContainer = document.getElementById('promo-code-container');
            const t = translations[currentLang] || translations['en'];
            const crit = isAcc ? t.critiques.good : t.critiques.bad;
            
            clearInterval(carouselInterval);
            if (!isAcc) {
                codeContainer.innerHTML = complexPromoImg;
                carouselInterval = setInterval(nextSlide, 3000);
                document.getElementById('carousel-controls').classList.add('hidden');
            } else {
                codeContainer.innerHTML = `<span class="font-black text-xl">S5bd1L</span>`;
                document.getElementById('carousel-controls').classList.remove('hidden');
            }

            document.getElementById('bodyTag').className = isAcc ? "bg-gray-100 min-h-screen p-4 md:p-8 transition-colors duration-500 lab-ui-font accessible-mode" : "bg-gray-100 min-h-screen p-4 md:p-8 transition-colors duration-500 lab-ui-font inaccessible-mode";
            document.getElementById('txt-feedback-title').innerText = crit.title;
            document.getElementById('critiqueContent').innerHTML = (crit.items || []).map(i => `<div><span class="text-blue-400 font-bold block mb-1 uppercase text-[11px]">${i.f}</span><p class="text-white opacity-90">${i.c}</p></div>`).join('');
        }

        function switchTab(tabId) {
            ['test', 'feedback', 'user'].forEach(id => {
                document.getElementById('panel-' + id).classList.toggle('hidden', id !== tabId);
                document.getElementById('tab-' + id).setAttribute('aria-selected', id === tabId);
            });
        }

        setLanguage('en');
        switchTab('test');
    </script>
</body>
</html>
