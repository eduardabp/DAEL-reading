<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Experience - Digital Accessibility Empathy Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- CONSTANT LAB UI STYLES --- */
        .lab-ui-font { font-family: ui-sans-serif, system-ui, -apple-system, sans-serif !important; }
        .info-panel-container { min-height: 500px !important; display: flex; flex-direction: column; }
        .switch { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ef4444; transition: .4s; border-radius: 28px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #15803d; }
        input:checked + .slider:before { transform: translateX(22px); }
        .tab-btn { font-family: ui-sans-serif, system-ui, sans-serif !important; }
        .tab-btn[aria-selected="true"] { background-color: #111827; color: #60a5fa; border-bottom: 2px solid #60a5fa; }

        /* --- READING BARRIERS (CONTENT AREA) --- */
        .inaccessible-mode .reading-content { font-family: "Times New Roman", Times, serif !important; }
        
        .promo-banner {
            width: 100%; height: 60px;
            background-color: #ef4444; color: white;
            display: flex; align-items: center; justify-content: center;
            font-weight: 900; overflow: hidden; position: relative;
            border-top-left-radius: 8px; border-top-right-radius: 8px;
        }
        .promo-text { white-space: nowrap; animation: slide 4s linear infinite; }
        @keyframes slide { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        
        .inaccessible-mode .promo-banner { 
            animation: flash 1s step-end infinite; 
            border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;
            margin-bottom: 24px; 
        }
        @keyframes flash { 50% { background-color: #facc15; color: black; } }

        .inaccessible-mode #txt-instructions {
            text-align: justify;
            line-height: 0.95 !important;
            letter-spacing: -0.04em !important;
            font-size: 14px;
        }

        .inaccessible-mode #txt-instr-title {
            font-size: 14px !important;
            margin-bottom: 2px !important;
            text-transform: none !important;
        }
        
        .inaccessible-mode .cog-label { 
            font-size: 12px !important; 
            text-transform: uppercase !important; 
            font-weight: 900 !important; 
        }

        /* --- ACCESSIBLE MODE --- */
        .accessible-mode .reading-content { font-family: ui-sans-serif, system-ui, sans-serif !important; }
        .accessible-mode .promo-banner { background-color: #1e40af; animation: none; margin-bottom: 0; }
        .accessible-mode .promo-text { animation-play-state: paused; }
        .accessible-mode.playing .promo-text { animation-play-state: running; }

        .accessible-mode #txt-instructions {
            text-align: left;
            line-height: 1.8;
            font-size: 14px; 
        }
        .accessible-mode .cog-label { 
            font-size: 14px !important; 
            text-transform: none !important; 
            font-weight: 600; 
            letter-spacing: 0.01em; 
        }
        .accessible-mode .form-gap { gap: 1.5rem !important; }

        /* Control Button */
        .control-btn {
            display: flex; align-items: center; justify-content: center;
            width: 36px; height: 36px; border: 2px solid #1e40af;
            border-radius: 8px; background: white; color: #1e40af;
            margin-top: 4px; margin-bottom: 24px; 
            transition: all 0.2s; cursor: pointer; font-size: 1.1rem;
        }
        .control-btn:hover { background: #f3f4f6; }

        .instr-list br { content: ""; display: block; margin: 0.75rem 0; }

        /* Error States */
        .input-error { border: 2px solid #ef4444 !important; }
        .error-msg { color: #ef4444; font-size: 12px; font-weight: bold; margin-top: 4px; display: block; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 transition-colors duration-500 lab-ui-font" id="bodyTag">

    <div class="max-w-7xl mx-auto bg-white shadow-2xl rounded-3xl overflow-hidden">
        <header class="bg-white border-b border-gray-100 lab-ui-font">
            <div class="p-6 flex flex-col md:flex-row justify-between items-center gap-6 border-b border-gray-50">
                <div id="txt-lab-title" class="text-xl md:text-2xl font-black tracking-tight uppercase" style="color: #008B63;">Digital Accessibility Empathy Lab</div>
                <img src="https://regine-lambrecht.github.io/color-contrast-checker-size-weight/images/banner.png" alt="Logo" class="h-12">
            </div>

            <nav class="p-4 flex flex-col gap-4">
                <div class="flex items-center justify-between gap-4 bg-gray-50 p-3 rounded-2xl border border-gray-200 w-full">
                    <div class="flex items-center gap-4">
                        <span id="txt-inaccessible" class="text-xs font-black uppercase tracking-widest text-red-600">Inaccessible</span>
                        <label class="switch">
                            <input type="checkbox" id="modeToggle" onchange="handleModeToggle()" role="switch">
                            <span class="slider"></span>
                        </label>
                        <span id="txt-accessible" class="text-xs font-black uppercase tracking-widest text-green-700">Accessible</span>
                    </div>
                    <div class="flex gap-2 text-[10px] font-bold">
                        <button onclick="setLanguage('en')" class="lang-btn px-2 py-1 rounded" id="btn-en">EN</button>
                        <button onclick="setLanguage('fr')" class="lang-btn px-2 py-1 rounded" id="btn-fr">FR</button>
                        <button onclick="setLanguage('nl')" class="lang-btn px-2 py-1 rounded" id="btn-nl">NL</button>
                        <button onclick="setLanguage('de')" class="lang-btn px-2 py-1 rounded" id="btn-de">DE</button>
                    </div>
                </div>
                <h1 id="txt-title" class="text-xl font-black text-gray-900 px-2 uppercase tracking-tighter">Reading Experience</h1>
            </nav>
        </header>

        <main class="p-6 md:p-10">
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-16">
                
                <div class="lg:col-span-2 reading-content flex flex-col form-gap" id="exercise-column">
                    <div id="form-container" class="contents">
                        <div class="flex flex-col">
                            <div class="promo-banner" id="banner">
                                <span class="promo-text" id="txt-promo">APPLY NOW! 50% OFF PROMO CODE: REDUCE2026</span>
                            </div>
                            <div id="controls-container" class="flex justify-end"></div>
                        </div>

                        <div id="vague-error" class="hidden bg-red-100 text-red-700 p-3 rounded-lg text-sm font-bold mb-4">Fail to submit form</div>

                        <div class="bg-blue-50 p-5 rounded-xl border border-blue-100 mt-4">
                            <h2 id="txt-instr-title" class="font-bold mb-3 uppercase text-lg text-blue-900 lab-ui-font">Instructions</h2>
                            <p id="txt-instructions" class="instr-list"></p>
                        </div>

                        <div class="space-y-4 mt-6">
                            <div>
                                <label id="txt-label-name" class="cog-label block mb-1">Name</label>
                                <input type="text" id="inp-name" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm lab-ui-font">
                                <span id="err-name" class="error-msg hidden"></span>
                            </div>

                            <div>
                                <label id="txt-label-code" class="cog-label block mb-1">CODE</label>
                                <input type="text" id="inp-code" class="w-full border border-gray-300 p-2 rounded-lg bg-gray-50 text-sm lab-ui-font">
                                <span id="err-code" class="error-msg hidden"></span>
                            </div>
                        </div>

                        <button id="txt-btn" onclick="validateForm()" class="w-full bg-blue-600 hover:bg-blue-800 text-white font-bold py-3 px-6 rounded-lg text-sm tracking-wide transition-colors lab-ui-font mt-6">OK</button>
                    </div>
                </div>

                <div class="lg:col-span-3">
                    <div class="info-panel-container bg-gray-900 text-white rounded-2xl shadow-xl overflow-hidden h-full flex flex-col lab-ui-font">
                        <div class="flex bg-gray-800 border-b border-gray-700">
                            <button id="tab-test" onclick="switchTab('test')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest" aria-selected="true">How to test</button>
                            <button id="tab-feedback" onclick="switchTab('feedback')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Issues</button>
                            <button id="tab-user" onclick="switchTab('user')" class="tab-btn px-6 py-4 text-xs font-black uppercase tracking-widest border-l border-gray-700" aria-selected="false">Impacted users</button>
                        </div>
                        <div id="panel-test" class="p-8 space-y-6 text-sm flex-grow">
                            <h3 id="txt-guide-title" class="text-blue-400 font-bold uppercase text-xs mb-2">Step-by-step guide</h3>
                            <ol id="txt-test-steps" class="list-decimal pl-5 space-y-4 opacity-95"></ol>
                        </div>
                        <div id="panel-feedback" class="p-8 hidden text-sm flex-grow overflow-y-auto">
                            <h3 id="txt-feedback-title" class="text-blue-400 font-bold uppercase mb-6"></h3>
                            <div id="critiqueContent" class="space-y-6"></div>
                        </div>
                        <div id="panel-user" class="p-8 hidden text-sm flex-grow overflow-y-auto">
                            <div id="txt-user-content"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const translations = {
            en: {
                inaccessible: "Inaccessible", accessible: "Accessible", labTitle: "Digital Accessibility Empathy Lab", title: "Reading Experience",
                name: { bad: "Name", good: "Full Name (required)" }, 
                code: { bad: "CODE", good: "Promotional Code (required)" }, 
                btn: { bad: "OK", good: "Submit Application" }, promo: "APPLY NOW! 50% OFF PROMO CODE: REDUCE2026",
                instrTitle: "Instructions", guideTitle: "Step-by-step guide", pauseAria: "Pause animation", playAria: "Play animation",
                tabTest: "How to test", tabUser: "Impacted users", tabIssues: "Issues", tabRemediations: "Remediations",
                successMsg: "Your request was successfully submitted",
                errReqName: "Full Name is required", errReqCode: "Promotional code is required", errInvalidCode: "Invalid promotional code",
                instr: {
                    bad: "The application process requires that users successfully identify and input the correct alphanumeric string found within the promotional messaging prior to confirmation. Please ensure the identity field contains the legal nomenclature matching your documentation. Applications missing the database-synced promotional code will be processed without the benefit of a secondary discount application.",
                    good: "To apply for your 50% discount:<br>1. In the 'Full Name' field, enter your name as it appears on your ID.<br>2. Enter the discount code (REDUCE2026) at the 'Promotional Code field' and activate the 'Submit Application' button."
                },
                testSteps: [
                    "Read the 'Instructions' block and identify the required pieces of information.",
                    "Look for the promotional code inside the moving banner at the top.",
                    "Try to complete the form without entering any data to see how the system handles errors.",
                    "Complete the form using the found information.",
                    "Switch to the accessible version and compare the clarity of instructions and error identification."
                ],
                critiques: {
                    bad: { title: "What is wrong?", items: [
                        { f: "1. Distracting Movement", c: "Constant flashing and scrolling content without a stop mechanism creates a 'sensory hijack' for users with ADHD or Autism." },
                        { f: "2. Passive & Dense Language", c: "Complex prose increases cognitive load unnecessarily." },
                        { f: "3. Vague Labels & Buttons", c: "Labels like 'Name', 'CODE' and 'OK' lack clarity and context." },
                        { f: "4. Poor Error Handling", c: "The 'Fail to submit form' message is vague and does not identify which field needs attention." },
                        { f: "5. Lack of Success Feedback", c: "In the inaccessible version, the form simply resets, leaving users unsure if their data was actually sent." }
                    ]},
                    good: { title: "Remediations", items: [
                        { f: "1. Control Mechanisms", c: "Always provide a mechanism to stop or pause movement (WCAG 2.2.2)." },
                        { f: "2. Plain Language", c: "Use short, active sentences and vertical breaks between steps to ensure understanding." },
                        { f: "3. Descriptive Labels", c: "Use clear labels like 'Full Name' and identify required fields explicitly." },
                        { f: "4. Clear Error Identification", c: "Mark errors specifically at the field level with visible indicators and helpful text (WCAG 3.3.1)." },
                        { f: "5. Persistent Success Messages", c: "Provide clear, permanent confirmation that a task has been completed successfully." }
                    ]}
                },
                userTitle: "Who is impacted?", userList: [
                    "**ADHD / Autism:** Benefit from reduced visual noise and the ability to stop motion.",
                    "**Dyslexia:** Benefit from clean fonts, generous spacing, and clear error messages.",
                    "**Cognitive Impairment:** Vague error messages like 'Fail to submit' cause significant confusion and frustration.",
                    "**Screen Reader Users:** Explicit error identification is required to navigate form failures effectively."
                ]
            }
        };

        let currentLang = 'en';
        let isPlaying = true;

        function toggleAnimation() {
            isPlaying = !isPlaying;
            const body = document.getElementById('bodyTag');
            const btn = document.getElementById('pauseBtn');
            const t = translations[currentLang] || translations['en'];
            
            if (isPlaying) {
                body.classList.add('playing');
                btn.innerHTML = "⏸";
                btn.setAttribute('aria-label', t.pauseAria);
            } else {
                body.classList.remove('playing');
                btn.innerHTML = "▶";
                btn.setAttribute('aria-label', t.playAria);
            }
        }

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang] || translations['en'];
            const isAcc = document.getElementById('modeToggle').checked;
            
            document.getElementById('txt-inaccessible').innerText = t.inaccessible;
            document.getElementById('txt-accessible').innerText = t.accessible;
            document.getElementById('txt-lab-title').innerText = t.labTitle;
            document.getElementById('txt-title').innerText = t.title;
            
            document.getElementById('txt-label-name').innerText = isAcc ? t.name.good : t.name.bad;
            document.getElementById('txt-label-code').innerText = isAcc ? t.code.good : t.code.bad;
            document.getElementById('txt-btn').innerText = isAcc ? t.btn.good : t.btn.bad;
            
            document.getElementById('txt-promo').innerText = t.promo;
            document.getElementById('txt-instr-title').innerText = t.instrTitle;
            document.getElementById('txt-instructions').innerHTML = isAcc ? t.instr.good : t.instr.bad;
            document.getElementById('txt-guide-title').innerText = t.guideTitle;
            document.getElementById('txt-test-steps').innerHTML = (t.testSteps || []).map(s => `<li>${s}</li>`).join('');

            document.getElementById('tab-test').innerText = t.tabTest;
            document.getElementById('tab-user').innerText = t.tabUser;
            document.getElementById('tab-feedback').innerText = isAcc ? t.tabRemediations : t.tabIssues;

            document.getElementById('txt-user-content').innerHTML = `
                <h3 class="text-blue-400 font-bold uppercase mb-4 text-xs">${t.userTitle || "Who is impacted?"}</h3>
                <ul class="list-disc pl-5 space-y-3">${(t.userList||[]).map(li => `<li>${li.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')}</li>`).join('')}</ul>
            `;

            updateMode();
            document.querySelectorAll('.lang-btn').forEach(b => {
                b.classList.remove('bg-blue-600', 'text-white', 'bg-gray-200', 'text-gray-700');
                if (b.id === 'btn-' + lang) b.classList.add('bg-blue-600', 'text-white');
                else b.classList.add('bg-gray-200', 'text-gray-700');
            });
        }

        function validateForm() {
            const isAcc = document.getElementById('modeToggle').checked;
            const nameVal = document.getElementById('inp-name').value.trim();
            const codeVal = document.getElementById('inp-code').value.trim();
            const t = translations[currentLang];

            // Reset errors
            document.getElementById('vague-error').classList.add('hidden');
            ['name', 'code'].forEach(id => {
                document.getElementById('inp-' + id).classList.remove('input-error');
                document.getElementById('err-' + id).classList.add('hidden');
            });

            let isValid = true;

            if (isAcc) {
                // Accessible Validation
                if (!nameVal) {
                    document.getElementById('inp-name').classList.add('input-error');
                    document.getElementById('err-name').innerText = t.errReqName;
                    document.getElementById('err-name').classList.remove('hidden');
                    isValid = false;
                }
                if (!codeVal) {
                    document.getElementById('inp-code').classList.add('input-error');
                    document.getElementById('err-code').innerText = t.errReqCode;
                    document.getElementById('err-code').classList.remove('hidden');
                    isValid = false;
                } else if (codeVal !== 'REDUCE2026') {
                    document.getElementById('inp-code').classList.add('input-error');
                    document.getElementById('err-code').innerText = t.errInvalidCode;
                    document.getElementById('err-code').classList.remove('hidden');
                    isValid = false;
                }

                if (isValid) {
                    document.getElementById('form-container').innerHTML = `
                        <div class="bg-green-100 text-green-800 p-8 rounded-2xl border-2 border-green-200 text-center font-bold text-lg">
                            ${t.successMsg}
                        </div>
                    `;
                }
            } else {
                // Inaccessible Validation
                if (!nameVal || !codeVal || codeVal !== 'REDUCE2026') {
                    document.getElementById('vague-error').classList.remove('hidden');
                } else {
                    // Success Inaccessible: Page refreshes, form empty, no message
                    document.getElementById('inp-name').value = '';
                    document.getElementById('inp-code').value = '';
                    window.scrollTo(0,0);
                }
            }
        }

        function handleModeToggle() {
            // Reload exercise column if it was replaced by success message
            if (!document.getElementById('form-container')) {
                location.reload(); 
            }
            setLanguage(currentLang);
        }

        function updateMode() {
            const isAcc = document.getElementById('modeToggle').checked;
            const container = document.getElementById('controls-container');
            const t = translations[currentLang] || translations['en'];
            const crit = isAcc ? t.critiques.good : t.critiques.bad;
            
            if (isAcc) {
                if (!document.getElementById('pauseBtn')) {
                    container.innerHTML = `<button id="pauseBtn" onclick="toggleAnimation()" class="control-btn" aria-label="${isPlaying ? t.pauseAria : t.playAria}">${isPlaying ? '⏸' : '▶'}</button>`;
                }
            } else {
                container.innerHTML = '';
            }

            document.getElementById('bodyTag').className = isAcc ? "bg-gray-100 min-h-screen p-4 md:p-8 transition-colors duration-500 lab-ui-font accessible-mode" : "bg-gray-100 min-h-screen p-4 md:p-8 transition-colors duration-500 lab-ui-font inaccessible-mode";
            if (isAcc && isPlaying) document.getElementById('bodyTag').classList.add('playing');

            document.getElementById('txt-feedback-title').innerText = crit.title;
            document.getElementById('critiqueContent').innerHTML = (crit.items || []).map(i => `<div><span class="text-blue-400 font-bold block mb-1 uppercase text-[11px]">${i.f}</span><p class="text-white opacity-90">${i.c}</p></div>`).join('');
        }

        function switchTab(tabId) {
            ['test', 'feedback', 'user'].forEach(id => {
                document.getElementById('panel-' + id).classList.toggle('hidden', id !== tabId);
                document.getElementById('tab-' + id).setAttribute('aria-selected', id === tabId);
            });
        }

        setLanguage('en');
        switchTab('test');
    </script>
</body>
</html>
